{% extends "base.html" %}

{% block title %}Git - {{ app_name }}{% endblock %}

{% block content %}
<div class="nav">
    <a href="/">Documents</a>
    <a href="/new">New</a>
    <a href="/upload">Upload</a>
    <a href="/search">Search</a>
    {% if git_enabled %}
    <a href="/git">Git</a>
    {% endif %}
    <a href="/push/subscribe">Push</a>
    <button type="button" class="pwa-refresh" data-pwa-refresh>
        Refresh
    </button>
    <button type="button" class="theme-toggle" data-theme-toggle aria-pressed="false">
        Theme
    </button>
</div>

<h1>Git</h1>

{% if !error.is_empty() %}
<div class="notice">{{ error }}</div>
{% endif %}
{% if !notice.is_empty() %}
<div class="notice">{{ notice }}</div>
{% endif %}

<p>{{ status }}</p>

{% if !new_files.is_empty() %}
<h2>New files</h2>
<ul class="git-new-files">
    {% for file in new_files %}
    <li>{{ file }}</li>
    {% endfor %}
</ul>
{% endif %}

<div class="git-actions">
    <form method="post" action="/git/pull">
        <button type="submit">Pull (fast-forward)</button>
    </form>
    <form method="post" action="/git/push">
        <button type="submit">Push</button>
    </form>
</div>

<form method="post" action="/git/commit">
    <label for="message">Commit message</label>
    <textarea id="message" name="message" rows="4" required>{{ message }}</textarea>
    <button type="submit">Commit changes</button>
</form>

<pre class="git-diff">{{ diff }}</pre>
{% endblock %}
